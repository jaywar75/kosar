{% extends "account/base.html" %}
{% block content %}
<h2>Create or Edit User</h2>

<form method="POST" action="">
    <!-- First Name -->
    <label for="first_name">First Name:</label>
    <input
        type="text"
        id="first_name"
        name="first_name"
        value="{{ user.first_name if user else '' }}"
        required
    >

    <!-- Last Name -->
    <label for="last_name">Last Name:</label>
    <input
        type="text"
        id="last_name"
        name="last_name"
        value="{{ user.last_name if user else '' }}"
        required
    >

    <!-- Email -->
    <label for="email">Email:</label>
    <input
        type="email"
        id="email"
        name="email"
        value="{{ user.email if user else '' }}"
        required
    >

    <!-- Username -->
    <label for="username">Username:</label>
    <input
        type="text"
        id="username"
        name="username"
        value="{{ user.username if user else '' }}"
        required
    >

    <!-- Password -->
    <label for="password">Password:</label>
    <input
        type="password"
        id="password"
        name="password"
        {% if action == 'create' %}
          required
        {% endif %}
        placeholder="Leave blank if not changing password"
    >

    <!-- Account Dropdown -->
    <label for="account_id">Associated Account:</label>
    <select id="account_id" name="account_id">
        <option value="">(No associated account)</option>
        {% for acct in accounts %}
            {% set acct_id_str = acct._id|string %}
            <option
                value="{{ acct_id_str }}"
                {% if user and user.account_id and acct_id_str == (user.account_id|string) %}
                    selected
                {% endif %}
            >
                {{ acct.company_name }}
            </option>
        {% endfor %}
    </select>

    <!-- Submit Button -->
    <button type="submit">
        {% if action == 'create' %}Next (Review){% else %}Next (Review){% endif %}
    </button>
</form>

{% endblock %}